<!DOCTYPE html>
<html lang="en">
<head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Management System</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for timeline and admin list */
        .timeline-container::-webkit-scrollbar,
        #admin-room-list::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }
        .timeline-container::-webkit-scrollbar-track,
        #admin-room-list::-webkit-scrollbar-track {
            background: rgba(203, 213, 225, 0.3);
            border-radius: 10px;
        }
        .timeline-container::-webkit-scrollbar-thumb,
        #admin-room-list::-webkit-scrollbar-thumb {
            background: rgba(129, 140, 248, 0.6);
            border-radius: 10px;
        }
        .timeline-container::-webkit-scrollbar-thumb:hover,
        #admin-room-list::-webkit-scrollbar-thumb:hover {
            background: rgba(99, 102, 241, 0.8);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-sky-100 to-indigo-200 font-sans text-slate-800 min-h-screen">
    <!-- Loading Screen -->
    <div id="app-loader" class="fixed inset-0 bg-white/70 backdrop-blur-sm flex items-center justify-center z-50">
        <div class="flex flex-col items-center">
            <svg class="animate-spin h-10 w-10 text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <p class="mt-4 text-lg font-medium text-slate-600">Loading System...</p>
        </div>
    </div>

    <!-- Main Container -->
    <div id="app-container" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 opacity-0 transition-opacity duration-500">
        <!-- Header -->
        <header class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 pb-4 border-b border-white/30">
            <div>
                <h1 class="text-3xl font-bold text-slate-900">Room Management</h1>
                <p id="user-greeting" class="text-slate-600 mt-1">Welcome!</p>
            </div>
            <!-- Admin Panel Button -->
            <button id="admin-panel-btn" class="hidden mt-4 sm:mt-0 bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-105 flex items-center">
                <i data-lucide="shield-check" class="w-5 h-5 mr-2"></i>
                Admin Panel
            </button>
        </header>

        <!-- Date Selector -->
        <div class="mb-8 p-4 bg-white/60 backdrop-blur-md border border-white/30 rounded-xl shadow-md">
            <label for="date-picker" class="block text-sm font-medium text-slate-700 mb-2">Select Date:</label>
            <input type="date" id="date-picker" class="w-full sm:w-auto p-2 border border-slate-300/50 bg-white/80 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
        </div>

        <!-- Rooms Display -->
        <main id="rooms-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Room cards will be inserted here by JavaScript -->
        </main>
    </div>

    <!-- Booking Modal -->
    <div id="booking-modal" class="fixed inset-0 bg-slate-900/70 backdrop-blur-md hidden items-center justify-center p-4 z-20">
        <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-xl shadow-2xl w-full max-w-md transform transition-all">
            <div class="p-6">
                <h3 class="text-2xl font-bold text-indigo-700 mb-2">Book a Room</h3>
                <p class="text-slate-600 mb-6">Booking: <span id="booking-room-name" class="font-semibold"></span></p>
                <form id="booking-form">
                    <input type="hidden" id="book-room-name-input">
                    <div class="mb-4">
                        <label for="book-date" class="block text-sm font-medium text-slate-700">Date</label>
                        <input type="date" id="book-date" required class="mt-1 block w-full px-3 py-2 bg-white/90 border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-6">
                        <div>
                            <label for="start-time" class="block text-sm font-medium text-slate-700">Start Time</label>
                            <input type="time" id="start-time" required step="1800" class="mt-1 block w-full px-3 py-2 bg-white/90 border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="end-time" class="block text-sm font-medium text-slate-700">End Time</label>
                            <input type="time" id="end-time" required step="1800" class="mt-1 block w-full px-3 py-2 bg-white/90 border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                        </div>
                    </div>
                    <div class="flex justify-end gap-3">
                        <button type="button" id="cancel-booking-btn" class="bg-slate-200/80 text-slate-800 font-bold py-2 px-4 rounded-lg hover:bg-slate-300/90 transition-colors">Cancel</button>
                        <button type="submit" id="submit-booking-btn" class="bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow-lg hover:bg-indigo-700 transition-colors flex items-center justify-center">
                            <span class="btn-text">Confirm Booking</span>
                            <svg class="animate-spin h-5 w-5 text-white hidden btn-loader" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Admin Modal -->
    <div id="admin-modal" class="fixed inset-0 bg-slate-900/70 backdrop-blur-md hidden items-center justify-center p-4 z-20">
        <div class="bg-white/80 backdrop-blur-xl border border-white/20 rounded-xl shadow-2xl w-full max-w-lg transform transition-all flex flex-col max-h-[90vh]">
            <div class="p-6 border-b border-white/30">
                <h3 class="text-2xl font-bold text-indigo-700">Admin Panel</h3>
            </div>
            
            <!-- Add Room Section -->
            <div class="p-6">
                <form id="add-room-form">
                    <h4 class="text-lg font-semibold text-slate-800 mb-3">Add New Room</h4>
                    <div class="grid sm:grid-cols-2 gap-4 mb-4">
                        <div>
                            <label for="new-room-name" class="block text-sm font-medium text-slate-700">Room Name</label>
                            <input type="text" id="new-room-name" placeholder="e.g., The Bridge" required class="mt-1 block w-full px-3 py-2 bg-white/90 border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="new-room-desc" class="block text-sm font-medium text-slate-700">Description</label>
                            <input type="text" id="new-room-desc" placeholder="e.g., Seats 12, Video Conferencing" required class="mt-1 block w-full px-3 py-2 bg-white/90 border border-slate-300 rounded-md text-sm shadow-sm focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500">
                        </div>
                    </div>
                    <div class="flex justify-end">
                        <button type="submit" id="submit-room-btn" class="bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg shadow-md hover:bg-indigo-700 transition-colors flex items-center justify-center">
                            <span class="btn-text">Add Room</span>
                            <svg class="animate-spin h-5 w-5 text-white hidden btn-loader" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Manage Rooms Section -->
            <div class="border-t border-white/30 p-6 flex-grow overflow-y-auto">
                <h4 class="text-lg font-semibold text-slate-800 mb-3">Manage Existing Rooms</h4>
                <div id="admin-room-list" class="space-y-3 pr-2">
                    <!-- Room list will be populated here -->
                </div>
            </div>

            <div class="p-4 bg-white/10 border-t border-white/30 flex justify-end">
                <button type="button" id="cancel-admin-btn" class="bg-slate-200/80 text-slate-800 font-bold py-2 px-4 rounded-lg hover:bg-slate-300/90 transition-colors">Close</button>
            </div>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed top-8 right-8 bg-green-500 text-white py-3 px-6 rounded-lg shadow-xl text-lg font-semibold transform translate-x-[150%] transition-transform duration-500 ease-in-out">
        <p id="toast-message"></p>
    </div>

    <!-- JavaScript -->
    <script>
        // --- STATE MANAGEMENT ---
        let currentUser = {};
        let rooms = [];
        let bookings = [];

        // --- DOM ELEMENTS ---
        const appLoader = document.getElementById('app-loader');
        const appContainer = document.getElementById('app-container');
        const datePicker = document.getElementById('date-picker');
        const roomsGrid = document.getElementById('rooms-grid');
        const userGreeting = document.getElementById('user-greeting');
        const adminPanelBtn = document.getElementById('admin-panel-btn');
        
        const bookingModal = document.getElementById('booking-modal');
        const bookingForm = document.getElementById('booking-form');
        const cancelBookingBtn = document.getElementById('cancel-booking-btn');
        
        const adminModal = document.getElementById('admin-modal');
        const addRoomForm = document.getElementById('add-room-form');
        const cancelAdminBtn = document.getElementById('cancel-admin-btn');
        const adminRoomList = document.getElementById('admin-room-list');
        
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toLocaleDateString('en-CA');
            datePicker.value = today;
            document.getElementById('book-date').value = today;
            
            google.script.run
                .withSuccessHandler(initializeApp)
                .withFailureHandler(showErrorToast)
                .getInitialData();

            // Event Listeners
            datePicker.addEventListener('change', handleDateChange);
            adminPanelBtn.addEventListener('click', openAdminPanel);
            cancelAdminBtn.addEventListener('click', () => adminModal.style.display = 'none');
            addRoomForm.addEventListener('submit', handleAddRoom);
            cancelBookingBtn.addEventListener('click', () => bookingModal.style.display = 'none');
            bookingForm.addEventListener('submit', handleBookRoom);
        });

        /**
         * Initializes the app with fetched data
         * @param {Object} data - Contains user, rooms, and bookings
         */
        function initializeApp(data) {
            currentUser = data.user;
            rooms = data.rooms;
            bookings = data.bookings;
            
            userGreeting.textContent = 'Welcome, ' + currentUser.email.split('@')[0];
            if (currentUser.isAdmin) {
                adminPanelBtn.classList.remove('hidden');
            }
            
            renderRooms();
            
            appLoader.style.display = 'none';
            appContainer.classList.remove('opacity-0');
        }

        /**
         * Renders all room cards with booking timelines
         */
        function renderRooms() {
            roomsGrid.innerHTML = '';
            if (!rooms || rooms.length === 0) {
                roomsGrid.innerHTML = '<div class="col-span-full text-center p-10 bg-white/50 backdrop-blur-md rounded-xl shadow-lg border border-white/20"><h3 class="text-xl font-semibold text-slate-700">No rooms available</h3><p class="text-slate-500 mt-2">An administrator needs to add rooms via the Admin Panel.</p></div>';
                return;
            }

            rooms.forEach(room => {
                const roomCard = document.createElement('div');
                roomCard.className = 'bg-white/60 backdrop-blur-md border border-white/20 rounded-xl shadow-lg p-6 flex flex-col transition-all duration-300 hover:shadow-2xl hover:-translate-y-1';
                roomCard.innerHTML = '<div class="flex-grow"><h2 class="text-xl font-bold text-slate-900">' + room.name + '</h2><p class="text-slate-600 text-sm mb-4 min-h-[20px]">' + (room.description || '') + '</p><div class="timeline-container overflow-x-auto pb-2"><div class="relative h-16 w-[1200px]">' + Array.from({length: 24}, (_, i) => '<div class="absolute top-0 text-xs text-slate-500 text-center" style="left: ' + (i * 50) + 'px; width: 50px;">' + String(i).padStart(2,'0') + ':00</div>').join('') + '<div class="absolute top-6 h-2 w-full bg-slate-900/10 rounded-full"></div><div id="timeline-' + room.name.replace(/\s+/g, '-') + '" class="absolute top-4 h-6"></div></div></div></div><button data-room-name="' + room.name + '" class="book-btn mt-6 w-full bg-indigo-600 text-white font-bold py-2.5 px-4 rounded-lg shadow-lg hover:bg-indigo-700 transition-all duration-300 transform hover:scale-105">Book this Room</button>';
                roomsGrid.appendChild(roomCard);
                renderBookingsForRoom(room.name);
            });
            
            document.querySelectorAll('.book-btn').forEach(btn => btn.addEventListener('click', openBookingModal));
        }

        /**
         * Renders booking timeline for a specific room
         * @param {string} roomName - The room name
         */
        function renderBookingsForRoom(roomName) {
            const timeline = document.getElementById('timeline-' + roomName.replace(/\s+/g, '-'));
            timeline.innerHTML = '';
            const roomBookings = bookings.filter(b => b.roomName === roomName);

            roomBookings.forEach(booking => {
                try {
                    if (!booking.startTime || !booking.endTime) return;

                    const startHour = parseInt(booking.startTime.split(':')[0]);
                    const startMinute = parseInt(booking.startTime.split(':')[1]);
                    const endHour = parseInt(booking.endTime.split(':')[0]);
                    const endMinute = parseInt(booking.endTime.split(':')[1]);

                    const startPosition = (startHour * 50) + (startMinute / 60 * 50);
                    const endPosition = (endHour * 50) + (endMinute / 60 * 50);
                    const width = Math.max(0, endPosition - startPosition);

                    const isOwnBooking = booking.userEmail === currentUser.email;
                    const isCancelled = booking.status === 'Cancelled';
                    const canCancel = (isOwnBooking || currentUser.isAdmin) && !isCancelled;
                    
                    let bgColor = isCancelled ? 'bg-slate-500' : (isOwnBooking ? 'bg-emerald-500' : 'bg-sky-500');

                    const bookingEl = document.createElement('div');
                    bookingEl.className = 'absolute h-8 -top-1 rounded-lg px-2 flex items-center justify-between text-xs font-medium text-white shadow-lg ' + bgColor + ' border-2 border-white/50';
                    bookingEl.style.left = startPosition + 'px';
                    bookingEl.style.width = width + 'px';
                    
                    const titleText = booking.userName + ' (' + booking.startTime + '-' + booking.endTime + ') ' + (isCancelled ? '[Cancelled]' : '');
                    const adminDeleteBtn = currentUser.isAdmin ? '<button data-booking-id="' + booking.bookingId + '" class="delete-booking-btn ml-1 rounded-full w-5 h-5 flex items-center justify-center bg-black/20 hover:bg-red-500 transition-colors" title="Permanently Delete"><i data-lucide="trash-2" class="w-3 h-3"></i></button>' : '';
                        
                    bookingEl.innerHTML = '<span class="truncate ' + (isCancelled ? 'line-through' : '') + '" title="' + titleText + '">' + booking.userName + '</span><div class="flex items-center">' + (canCancel ? '<button data-booking-id="' + booking.bookingId + '" class="cancel-booking-btn ml-2 rounded-full w-5 h-5 flex items-center justify-center bg-black/20 hover:bg-amber-500 transition-colors" title="Cancel Booking"><i data-lucide="x" class="w-4 h-4"></i></button>' : '') + adminDeleteBtn + '</div>';
                    timeline.appendChild(bookingEl);
                } catch (error) {
                    console.error('Failed to render a booking:', booking, error);
                }
            });
            
            lucide.createIcons();
            document.querySelectorAll('.cancel-booking-btn').forEach(btn => btn.addEventListener('click', handleCancelBooking));
            document.querySelectorAll('.delete-booking-btn').forEach(btn => btn.addEventListener('click', handleDeleteBooking));
        }
        
        /**
         * Renders the admin room management list
         */
        function renderAdminRoomList() {
            adminRoomList.innerHTML = '';
            if (!rooms || rooms.length === 0) {
                adminRoomList.innerHTML = '<p class="text-slate-500 text-sm text-center py-4">No rooms to manage.</p>';
                return;
            }
            
            rooms.forEach(room => {
                const roomEl = document.createElement('div');
                roomEl.className = 'flex items-center justify-between bg-white/50 p-3 rounded-lg border border-white/30';
                roomEl.innerHTML = '<div><p class="font-semibold text-slate-800">' + room.name + '</p><p class="text-xs text-slate-500">' + room.description + '</p></div><button data-room-name="' + room.name + '" class="remove-room-btn text-red-500 hover:text-white hover:bg-red-500 w-8 h-8 rounded-full flex items-center justify-center transition-colors" title="Delete Room"><i data-lucide="trash-2" class="w-4 h-4"></i></button>';
                adminRoomList.appendChild(roomEl);
            });

            lucide.createIcons();
            document.querySelectorAll('.remove-room-btn').forEach(btn => btn.addEventListener('click', handleRemoveRoom));
        }

        // --- EVENT HANDLERS ---
        function openAdminPanel() {
            renderAdminRoomList();
            adminModal.style.display = 'flex';
        }

        function handleDateChange(e) {
            appLoader.style.display = 'flex';
            google.script.run
                .withSuccessHandler(newBookings => {
                    bookings = newBookings;
                    renderRooms();
                    appLoader.style.display = 'none';
                })
                .withFailureHandler(showErrorToast)
                .getBookingsForDate(e.target.value);
        }

        function openBookingModal(e) {
            const roomName = e.target.dataset.roomName;
            document.getElementById('booking-room-name').textContent = roomName;
            document.getElementById('book-room-name-input').value = roomName;
            document.getElementById('book-date').value = datePicker.value;
            bookingModal.style.display = 'flex';
        }

        function handleBookRoom(e) {
            e.preventDefault();
            const btn = document.getElementById('submit-booking-btn');
            toggleButtonSpinner(btn, true);

            const bookingDetails = {
                roomName: document.getElementById('book-room-name-input').value,
                date: document.getElementById('book-date').value,
                startTime: document.getElementById('start-time').value,
                endTime: document.getElementById('end-time').value
            };

            if (new Date('1970-01-01T' + bookingDetails.endTime) <= new Date('1970-01-01T' + bookingDetails.startTime)) {
                showErrorToast({message: 'End time must be after start time.'});
                toggleButtonSpinner(btn, false);
                return;
            }

            google.script.run
                .withSuccessHandler(result => {
                    toggleButtonSpinner(btn, false);
                    if (result.success) {
                        showSuccessToast(result.message);
                        bookingModal.style.display = 'none';
                        bookingForm.reset();
                        handleDateChange({target: {value: datePicker.value}});
                    } else {
                        showErrorToast(result);
                    }
                })
                .withFailureHandler(err => {
                    toggleButtonSpinner(btn, false);
                    showErrorToast(err);
                })
                .bookRoom(bookingDetails);
        }

        function handleCancelBooking(e) {
            const bookingId = e.target.closest('button').dataset.bookingId;
            if (confirm('Are you sure you want to cancel this booking?')) {
                appLoader.style.display = 'flex';
                google.script.run
                    .withSuccessHandler(result => {
                        appLoader.style.display = 'none';
                        if (result.success) {
                            showSuccessToast(result.message);
                            handleDateChange({target: {value: datePicker.value}});
                        } else {
                            showErrorToast(result);
                        }
                    })
                    .withFailureHandler(err => {
                        appLoader.style.display = 'none';
                        showErrorToast(err);
                    })
                    .cancelBooking(bookingId);
            }
        }

        function handleDeleteBooking(e) {
            const bookingId = e.target.closest('button').dataset.bookingId;
            if (confirm('DANGER: This will permanently delete the booking record.\nAre you sure you want to proceed?')) {
                appLoader.style.display = 'flex';
                google.script.run
                    .withSuccessHandler(result => {
                        appLoader.style.display = 'none';
                        if (result.success) {
                            showSuccessToast(result.message);
                            handleDateChange({target: {value: datePicker.value}});
                        } else {
                            showErrorToast(result);
                        }
                    })
                    .withFailureHandler(err => {
                        appLoader.style.display = 'none';
                        showErrorToast(err);
                    })
                    .deleteBooking(bookingId);
            }
        }

        function handleAddRoom(e) {
            e.preventDefault();
            const btn = document.getElementById('submit-room-btn');
            toggleButtonSpinner(btn, true);

            const roomName = document.getElementById('new-room-name').value;
            const description = document.getElementById('new-room-desc').value;

            google.script.run
                .withSuccessHandler(result => {
                    toggleButtonSpinner(btn, false);
                    if (result.success) {
                        showSuccessToast(result.message);
                        addRoomForm.reset();
                        google.script.run.withSuccessHandler(data => {
                            initializeApp(data);
                            renderAdminRoomList();
                        }).getInitialData();
                    } else {
                        showErrorToast(result);
                    }
                })
                .withFailureHandler(err => {
                    toggleButtonSpinner(btn, false);
                    showErrorToast(err);
                })
                .addRoom(roomName, description);
        }

        function handleRemoveRoom(e) {
            const roomName = e.target.closest('button').dataset.roomName;
            if (confirm('Are you sure you want to PERMANENTLY delete the room "' + roomName + '" and all of its bookings? This cannot be undone.')) {
                appLoader.style.display = 'flex';
                google.script.run
                    .withSuccessHandler(result => {
                        if (result.success) {
                            showSuccessToast(result.message);
                            google.script.run.withSuccessHandler(data => {
                                initializeApp(data);
                                adminModal.style.display = 'none';
                                appLoader.style.display = 'none';
                            }).getInitialData();
                        } else {
                            showErrorToast(result);
                            appLoader.style.display = 'none';
                        }
                    })
                    .withFailureHandler(err => {
                        appLoader.style.display = 'none';
                        showErrorToast(err);
                    })
                    .removeRoom(roomName);
            }
        }

        // --- UTILITY FUNCTIONS ---
        function showSuccessToast(message) {
            showToast(message, 'bg-emerald-500');
        }

        function showErrorToast(error) {
            const message = error.message || 'An unknown error occurred.';
            showToast(message, 'bg-red-500');
        }

        function showToast(message, bgColor) {
            toastMessage.textContent = message;
            toast.className = 'fixed top-8 right-8 text-white py-3 px-6 rounded-lg shadow-xl text-lg font-semibold transform transition-transform duration-500 ease-in-out ' + bgColor + ' translate-x-0';
            setTimeout(() => {
                toast.style.transform = 'translateX(150%)';
            }, 4000);
        }

        function toggleButtonSpinner(button, show) {
            const text = button.querySelector('.btn-text');
            const loader = button.querySelector('.btn-loader');
            if (show) {
                button.disabled = true;
                text.classList.add('hidden');
                loader.classList.remove('hidden');
            } else {
                button.disabled = false;
                text.classList.remove('hidden');
                loader.classList.add('hidden');
            }
        }
    </script>
    
    <script>
        lucide.createIcons();
    </script>
</body>
</html>